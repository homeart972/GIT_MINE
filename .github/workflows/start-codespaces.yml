name: Start GitHub Codespaces

on:
  workflow_dispatch:  # Permet de lancer manuellement
  schedule:
    - cron: '45 18 * * *'  # Déclenche à 18h45 UTC
    - cron: '45 19 * * *'  # Redémarrage à 19h45 si besoin

jobs:
  start-codespace:
    runs-on: ubuntu-latest
    steps:
      - name: Start Codespace
        run: |
          gh codespace list --json name,state | jq -r '.[] | select(.state=="Shutdown") | .name' | while read codespace; do
            gh codespace start --codespace "$codespace"
          done
        env:
          GH_TOKEN: ${{ secrets.GH_PAT }}  # Utilisation du GH_PAT existant OK
